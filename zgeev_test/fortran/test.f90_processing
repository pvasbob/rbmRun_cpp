program DiagonalizeComplexMatrix
    implicit none

    ! Implicit None
    Integer, Parameter :: pr = Kind(1.0d0)
    Integer, Parameter :: dim = 3
    Complex(pr) :: mat(dim, dim)
    Complex(pr) :: eigenvalue(dim)
    Integer :: info
    Integer :: i, j

    ! Manually initialize a 3x3 complex matrix with non-defective eigenvalues
    mat(1, 1) = (1.0_pr, 0.5_pr)
    mat(1, 2) = (2.0_pr, 1.5_pr)
    mat(1, 3) = (3.0_pr, 2.5_pr)
    mat(2, 1) = (0.0_pr, 1.0_pr)
    mat(2, 2) = (1.0_pr, 1.0_pr)
    mat(2, 3) = (4.0_pr, 0.0_pr)
    mat(3, 1) = (0.0_pr, 1.5_pr)
    mat(3, 2) = (0.0_pr, 2.0_pr)
    mat(3, 3) = (2.0_pr, 0.0_pr)

    ! Print the original matrix
    Print *, "Original Complex Matrix A:"
    Do i = 1, dim
        Do j = 1, dim
            Print *, mat(i, j)
        End Do
    End Do

    ! Call zgeev
    Call zgeev('N', 'V', dim, mat, dim, eigenvalue, 0, 1, 0, 1, 0, 1, 0, info)

    ! Check for successful computation
    If (info == 0) Then
        ! Print eigenvalues
        Print *, "Eigenvalues:"
        Do i = 1, dim
            Print *, eigenvalue(i)
        End Do
    Else
        Print *, "Error: zgeev failed with info =", info
    End If

End program DiagonalizeComplexMatrix
